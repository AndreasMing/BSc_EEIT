---
format:
  pdf:
    include-in-header:
      - config.tex
    keep-tex: true
    title-block-style: none
geometry: 
- "top=20mm"
- "bottom=20mm"
- "left=20mm"
- "right=20mm"
papersize: a4paper
fontsize: 10pt

highlight-style: github


pdf-engine: "pdflatex"

editor: visual
---

```{=latex}
\begin{titlepage}
  \textsf{
    \makeatletter
    \Huge{\textbf{Zusammenfassung MCFUN}
    } \\
    \normalsize{
      \begin{tabularx}{\textwidth}{lr}
        Joel von Rotz & \today
      \end{tabularx}
    }
    \makeatother
  }
\end{titlepage}
```
# Wichtige Seiten Reference Manual

+-------------------------------------------------------------------------------------------------------------+----------------------------------------+
| Beschreibung                                                                                                | Seitenzahl                             |
+=============================================================================================================+========================================+
| Signal Multiplexing and Pin Assignments                                                                     | s.216                                  |
+-------------------------------------------------------------------------------------------------------------+----------------------------------------+
| Port Control and Interrupts **`PORT`**                                                                      | s.239 (Register $\rightarrow$ s.248)   |
+-------------------------------------------------------------------------------------------------------------+----------------------------------------+
| System Integration Module **`SIM`**                                                                         | s.259 (Register $\rightarrow$ s.261)   |
+-------------------------------------------------------------------------------------------------------------+----------------------------------------+
| Analog Digital Converter **`ADC`**                                                                          | s.761 (Register $\rightarrow$ s.768)   |
+-------------------------------------------------------------------------------------------------------------+----------------------------------------+
| FlexTimer Module **`FTM`**                                                                                  | s.891 (Register $\rightarrow$ s.903)   |
+-------------------------------------------------------------------------------------------------------------+----------------------------------------+
| Serial Peripheral Interface **`SPI`**                                                                       | s.1123 (Register $\rightarrow$ s.1132) |
|                                                                                                             |                                        |
| $\rightarrow$ MOSI, MISO, SCLK, $\overline{\text{SS}} \times \#_{SLAVES}$ (ausser Ring-Topologie, dann $1$) |                                        |
+-------------------------------------------------------------------------------------------------------------+----------------------------------------+
| Inter-Integrated Circuit **`I2C`**                                                                          | s.1181 (Register $\rightarrow$ s.1185) |
|                                                                                                             |                                        |
| $\rightarrow$ SDA, SCL                                                                                      |                                        |
+-------------------------------------------------------------------------------------------------------------+----------------------------------------+
| Universal Asynchronous Receiver/Transmitter **`UART`**                                                      | s.1215 (Register $\rightarrow$ s.1224) |
|                                                                                                             |                                        |
| $\rightarrow$ RX, TX                                                                                        |                                        |
+-------------------------------------------------------------------------------------------------------------+----------------------------------------+
| General Purpose Input/Output **`GPIO`**                                                                     | s.1375 (Register $\rightarrow$ s.1378) |
+-------------------------------------------------------------------------------------------------------------+----------------------------------------+

# Notes

## Inter-Integrated Circuit $I^2C$

::: callout-caution
## Open Drain Konfiguration nicht vergessen!

``` c
PORTx->PCR[n] |= PORT_PCR_ODE(0x1);
```
:::

### Clock/Bit Stretching

Wenn der Slave Daten verarbeiten muss, während der Master neue Daten abfragen/versenden möchte, kann der Slave die Clock Leitung auf *LOW* ziehen. Der Master erkennt dies und wartet auf den Slave, bis dieser die Clock-Leitung wieder freigibt.

![](images/paste-DD46C719.png){fig-align="center" width="337"}

Entsteht meistens nachdem der Slave Informationen erhalten hat.

## Multimaster

Wenn mehrere Master auf dem selben Bus anfangen zu kommunizieren, gewinnt der Master, welche die meisten Nullen schreibt. Alle anderen Master stoppen ihre Kommunikation.

## Assembler

## UART

### Baudraten Berechnung

$$
\text{Baud}=\frac{f_{CPU}}{16 \cdot (\text{SBR[12:0]} + \frac{\text{BRFA}}{32})}
$$

Die Division durch 16 wird für das Einlesen und Überprüfen der Nachricht verwendet (für Noise Check).

$$
\text{SBR[12:0]} + \frac{\text{BRFA}}{32} =\frac{f_{CPU}}{16 \cdot \text{Baud}}
$$

$\rightarrow$ $\text{SBR}_{MAX}= 8'191$ & $\text{BRFA}_{MAX}=32$ ($\frac{\text{1}}{32} = 0.03125$)
